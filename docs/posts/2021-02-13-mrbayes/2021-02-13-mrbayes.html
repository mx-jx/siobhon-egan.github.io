<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.449">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Siobhon Egan">
<meta name="dcterms.date" content="2021-02-13">
<meta name="description" content="Building trees with MrBayes">

<title>Siobhon Egan - MrBayes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Siobhon Egan - MrBayes">
<meta name="twitter:description" content="Building trees with MrBayes">
<meta name="twitter:image" content="https://www.siobhon-egan.github.io/images/profile.png">
<meta name="twitter:creator" content="@siobhon_egan">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="313">
<meta name="twitter:image-width" content="320">
</head>

<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Siobhon Egan</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/siobhon-egan/siobhon-egan.github.io"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/siobhon_egan"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#command-line" id="toc-command-line" class="nav-link active" data-scroll-target="#command-line">Command line</a>
  <ul class="collapse">
  <li><a href="#nexus-file-format" id="toc-nexus-file-format" class="nav-link" data-scroll-target="#nexus-file-format">1. Nexus file format</a></li>
  <li><a href="#activate-mrbayes" id="toc-activate-mrbayes" class="nav-link" data-scroll-target="#activate-mrbayes">2. Activate MrBayes</a></li>
  <li><a href="#specify-the-evolutionary-model" id="toc-specify-the-evolutionary-model" class="nav-link" data-scroll-target="#specify-the-evolutionary-model">3. Specify the evolutionary model</a></li>
  <li><a href="#setting-the-priors" id="toc-setting-the-priors" class="nav-link" data-scroll-target="#setting-the-priors">4. Setting the Priors</a></li>
  <li><a href="#running-analysis" id="toc-running-analysis" class="nav-link" data-scroll-target="#running-analysis">5. Running Analysis</a></li>
  <li><a href="#altering-the-model" id="toc-altering-the-model" class="nav-link" data-scroll-target="#altering-the-model">Altering the model</a></li>
  </ul></li>
  <li><a href="#web-server" id="toc-web-server" class="nav-link" data-scroll-target="#web-server">Web server</a>
  <ul class="collapse">
  <li><a href="#upload-data" id="toc-upload-data" class="nav-link" data-scroll-target="#upload-data">1. Upload data</a></li>
  <li><a href="#setting" id="toc-setting" class="nav-link" data-scroll-target="#setting">2. Setting</a></li>
  <li><a href="#submit" id="toc-submit" class="nav-link" data-scroll-target="#submit">3. Submit</a></li>
  <li><a href="#output" id="toc-output" class="nav-link" data-scroll-target="#output">4. Output</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MrBayes</h1>
  <div class="quarto-categories">
    <div class="quarto-category">genomics</div>
    <div class="quarto-category">phylogenetics</div>
  </div>
  </div>

<div>
  <div class="description">
    <p>Building trees with MrBayes</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Siobhon Egan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 13, 2021</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>Bayesian inference</p>
</blockquote>
<p><span class="badge badge-info">Phylogenetic analysis using Bayesian method</span></p>
<p>MrBayes is a program for Bayesian inference and model choice across a wide range of phylogenetic and evolutionary models. MrBayes uses Markov chain Monte Carlo (MCMC) methods to estimate the posterior distribution of model parameters. Here I have described two options of using MrBayes (i) command line and (ii) webserver.</p>
<p>🔗 <strong>Useful resources and links</strong></p>
<ul>
<li><a href="http://nbisweden.github.io/MrBayes/">Homepage</a></li>
<li><a href="http://mrbayes.sourceforge.net/mb3.2_manual.pdf">Manual v3.2</a></li>
<li><a href="http://mrbayes.sourceforge.net/wiki/index.php?title=Tutorial&amp;oldid=5239">Tutorial</a></li>
<li><a href="http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=3C92ACF672625E025B8EAE2291777B2F?doi=10.1.1.134.3825&amp;rep=rep1&amp;type=pdf">John P. Huelsenbeck and Fredrik Ronquist, Bayesian Analysis of Molecular Evolution Using MrBayes</a></li>
</ul>
<section id="command-line" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="command-line">Command line</h2>
<p>Instructions for commandline workflow on MacOS for MrBayes v3.2</p>
<p><strong>Install</strong></p>
<p>Instructions on how to installl MrBayes are available <a href="https://nbisweden.github.io/MrBayes/download.html">here</a> and <a href="http://mrbayes.sourceforge.net/wiki/index.php/Introduction_3.2">here</a>.</p>
<p>Download source code for compliation on Unix machines <a href="https://github.com/NBISweden/MrBayes/archive/v3.2.7a.tar.gz">3.2.7a</a>.</p>
<p>Open a terminal window and execute the following, remember you may need to navigate to change directory or move download file to currently working directory.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">~</span> tar zxf mrbayes-3.2.tar.gz</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">~</span> cd mrbayes-3.2</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">~/mrbayes-3.2</span> $ ./configure</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">~/mrbayes-3.2</span> $ make</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">~/mrbayes-3.2</span> $ export CC=MyCompiler</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="ex">~/mrbayes-3.2</span> % ./configure</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You should now be ready to start!</p>
<section id="nexus-file-format" class="level3">
<h3 class="anchored" data-anchor-id="nexus-file-format">1. Nexus file format</h3>
<p>You will need to convert your aligned sequence file to a nexus file first. Although this can commonly be done in most sequence analysis programs (e.g.&nbsp;geneious) using the <code>export as...</code> make sure you check the file formatting by opening the <code>nexus</code> file in a text editor program (e.g.&nbsp;atom).</p>
<p>I find a more reliable way is to use a web program to convert the fasta file to a nexus file - such as one available <a href="http://sequenceconversion.bugaco.com/converter/biology/sequences/fasta_to_nexus.php">here</a>. Make sure the sequence names do not contain any of the following; hyphens <code>-</code>, commas<code>,</code>, semicolcons <code>:</code>, exclamation marks <code>!</code>. Underscores <code>_</code> and periods <code>.</code> are okay.</p>
</section>
<section id="activate-mrbayes" class="level3">
<h3 class="anchored" data-anchor-id="activate-mrbayes">2. Activate MrBayes</h3>
<p>Type <code>mb</code> to activate MrBayes.</p>
<p>Set the data file for analysis</p>
<p><em>Example</em> - alignment file called <code>AlignedSeqs.nexus</code></p>
<p>This will check will ensure your data is formatting and read correctly by the program. Any issues at this point are most likely due to the syntax and formatting of your nexus file. Note: you may need to also include the path to the file if you are not already in the correct directory. Generic Shell commands (e.g.&nbsp;<code>ls</code> <code>cd</code>) do not work in the MrBayes environment.</p>
</section>
<section id="specify-the-evolutionary-model" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="specify-the-evolutionary-model">3. Specify the evolutionary model</h3>
<p>This is where you start to set the parameters for your analysis. You will likely need to do some background work to figure out which is the correct model for your data - <a href="../../posts/2021-02-13-phylo-models/2021-02-13-phylo-models.html">see here</a>.</p>
<p>If your data are not DNA or RNA, if you want to invoke a different model, or if you want to use non-default priors, refer to the MrBayes manual and Appendix for more help.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="mrbayes1.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">DNA models support by MrBayes v3 (MrBayes Manual p164)</figcaption>
</figure>
</div>
<p><strong>Specifying a model</strong></p>
<p>Type <code>help lset</code> for more information</p>
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 50%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th style="text-align: center;">Options</th>
<th style="text-align: right;">Current setting</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nucmodel</td>
<td style="text-align: center;">4by4/Doublet/Codon/Protein</td>
<td style="text-align: right;">4by4</td>
</tr>
<tr class="even">
<td>Nst</td>
<td style="text-align: center;">1(JC/F81)/2(HKY)/6(GTR)/Mixed</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>Code</td>
<td style="text-align: center;">Universal/Vertmt/Mycoplasma/Yeast/Ciliates/Metmt</td>
<td style="text-align: right;">Universal</td>
</tr>
<tr class="even">
<td>Ploidy</td>
<td style="text-align: center;">Haploid/Dilpoid/Zlinked</td>
<td style="text-align: right;">Diploid</td>
</tr>
<tr class="odd">
<td>Rates</td>
<td style="text-align: center;">Equal/Gamma/Propinv/Invgamma/Adgamma</td>
<td style="text-align: right;">Equal</td>
</tr>
<tr class="even">
<td>Ngammacat</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td>Nbetacat</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>Omegavar</td>
<td style="text-align: center;">Equal/Ny93/M3</td>
<td style="text-align: right;">Equal</td>
</tr>
<tr class="odd">
<td>Covarion</td>
<td style="text-align: center;">No/Yes</td>
<td style="text-align: right;">No</td>
</tr>
<tr class="even">
<td>Coding</td>
<td style="text-align: center;">All/Variable/Noabsencesites/Nopresencesites</td>
<td style="text-align: right;">All</td>
</tr>
<tr class="odd">
<td>Parsmodel</td>
<td style="text-align: center;">No/Yes</td>
<td style="text-align: right;">No</td>
</tr>
</tbody>
</table>
<p><em>Example</em> - Set to a GTR + I + G To set a General Time Reversible (GTR) model with Gamma (+G) invariable (+I) distribution, execute the following:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">lset</span> nst=6 rates=invgamma</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="setting-the-priors" class="level3">
<h3 class="anchored" data-anchor-id="setting-the-priors">4. Setting the Priors</h3>
<p><strong>Priors</strong> Type <code>help prset</code> for more information</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 36%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th style="text-align: center;">Options</th>
<th style="text-align: right;">Current setting</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tratiopr</td>
<td style="text-align: center;">Beta/Fixed</td>
<td style="text-align: right;">Beta(1.0,1.0)</td>
</tr>
<tr class="even">
<td>Revmatpr</td>
<td style="text-align: center;">Dirichlet/Fixed</td>
<td style="text-align: right;">Dirichlet(1.0,1.0,1.0,1.0,1.0,1.0)</td>
</tr>
<tr class="odd">
<td>Aamodelpr</td>
<td style="text-align: center;">Fixed/Mixed</td>
<td style="text-align: right;">Fixed(Poisson)</td>
</tr>
<tr class="even">
<td>Aarevmatpr</td>
<td style="text-align: center;">Dirichlet/Fixed</td>
<td style="text-align: right;">Dirichlet(1.0,1.0,…)</td>
</tr>
<tr class="odd">
<td>Omegapr</td>
<td style="text-align: center;">Dirichlet/Fixed</td>
<td style="text-align: right;">Dirichlet(1.0,1.0)</td>
</tr>
<tr class="even">
<td>Ny98omega1pr</td>
<td style="text-align: center;">Beta/Fixed</td>
<td style="text-align: right;">Beta(1.0,1.0)</td>
</tr>
<tr class="odd">
<td>Ny98omega3pr</td>
<td style="text-align: center;">Uniform/Exponential/Fixed</td>
<td style="text-align: right;">Exponential(1.0)</td>
</tr>
<tr class="even">
<td>M3omegapr</td>
<td style="text-align: center;">Exponential/Fixed</td>
<td style="text-align: right;">Exponential</td>
</tr>
<tr class="odd">
<td>Codoncatfreqs</td>
<td style="text-align: center;">Dirichlet/Fixed</td>
<td style="text-align: right;">Dirichlet(1.0,1.0,1.0)</td>
</tr>
<tr class="even">
<td>Statefreqpr</td>
<td style="text-align: center;">Dirichlet/Fixed</td>
<td style="text-align: right;">Dirichlet(1.0,1.0,1.0,1.0)</td>
</tr>
<tr class="odd">
<td>Shapepr</td>
<td style="text-align: center;">Uniform/Exponential/Fixed</td>
<td style="text-align: right;">Uniform(0.0,200.0)</td>
</tr>
<tr class="even">
<td>Ratecorrpr</td>
<td style="text-align: center;">Uniform/Fixed</td>
<td style="text-align: right;">Uniform(-1.0,1.0)</td>
</tr>
<tr class="odd">
<td>Pinvarpr</td>
<td style="text-align: center;">Uniform/Fixed</td>
<td style="text-align: right;">Uniform(0.0,1.0)</td>
</tr>
<tr class="even">
<td>Covswitchpr</td>
<td style="text-align: center;">Uniform/Exponential/Fixed</td>
<td style="text-align: right;">Uniform(0.0,100.0)</td>
</tr>
<tr class="odd">
<td>Symdirihyperpr</td>
<td style="text-align: center;">Uniform/Exponential/Fixed</td>
<td style="text-align: right;">Fixed(Infinity)</td>
</tr>
<tr class="even">
<td>Topologypr</td>
<td style="text-align: center;">Uniform/Constraints</td>
<td style="text-align: right;">Uniform</td>
</tr>
<tr class="odd">
<td>Brlenspr</td>
<td style="text-align: center;">Unconstrained/Clock</td>
<td style="text-align: right;">Unconstrained:Exp(10.0)</td>
</tr>
<tr class="even">
<td>Treeheightpr</td>
<td style="text-align: center;">Exponential/Gamma</td>
<td style="text-align: right;">Exponential(1.0)</td>
</tr>
<tr class="odd">
<td>Speciationpr</td>
<td style="text-align: center;">Uniform/Exponential/Fixed</td>
<td style="text-align: right;">Uniform(0.0,10.0)</td>
</tr>
<tr class="even">
<td>Extinctionpr</td>
<td style="text-align: center;">Uniform/Exponential/Fixed</td>
<td style="text-align: right;">Uniform(0.0,10.0)</td>
</tr>
<tr class="odd">
<td>Sampleprob</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">1.00</td>
</tr>
<tr class="even">
<td>Thetapr</td>
<td style="text-align: center;">Uniform/Exponential/Fixed</td>
<td style="text-align: right;">Uniform(0.0,10.0)</td>
</tr>
<tr class="odd">
<td>Nodeagepr</td>
<td style="text-align: center;">Unconstrained/Calibrated</td>
<td style="text-align: right;">Unconstrained</td>
</tr>
<tr class="even">
<td>Treeagepr</td>
<td style="text-align: center;">Fixed/Uniform/Offsetexponential</td>
<td style="text-align: right;">Fixed(1.00)</td>
</tr>
<tr class="odd">
<td>Clockratepr</td>
<td style="text-align: center;">Strict/Cpp/Bm</td>
<td style="text-align: right;">Strict</td>
</tr>
<tr class="even">
<td>Cppratepr</td>
<td style="text-align: center;">Fixed/Exponential</td>
<td style="text-align: right;">Exponential(0.10)</td>
</tr>
<tr class="odd">
<td>Psigammapr</td>
<td style="text-align: center;">Fixed/Exponential/Uniform</td>
<td style="text-align: right;">Fixed(1.00)</td>
</tr>
<tr class="even">
<td>Nupr</td>
<td style="text-align: center;">Fixed/Exponential/Uniform</td>
<td style="text-align: right;">Fixed(1.00)</td>
</tr>
<tr class="odd">
<td>Ratepr</td>
<td style="text-align: center;">Fixed/Variable=Dirichlet</td>
<td style="text-align: right;">Fixed</td>
</tr>
</tbody>
</table>
<p><em>Example</em> - Set the G and I parameters To manually set the shape parameter of the gamma distribution of rate variation (<code>Shapepr</code>) and the proportion of invariable sites (<code>Pinvarpr</code>), execute the following:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">prset</span> shapepr=fixed<span class="er">(</span><span class="ex">0.05</span><span class="kw">)</span> <span class="va">pinvarpr</span><span class="op">=</span>fixed<span class="kw">(</span><span class="ex">0.30</span><span class="kw">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="running-analysis" class="level3">
<h3 class="anchored" data-anchor-id="running-analysis">5. Running Analysis</h3>
<p>The analysis is started by issuing the mcmc command. However, before doing this, we recommend that you review the run settings by typing help mcmc. The help mcmc command will produce the following table at the bottom of the output:</p>
<table class="table">
<thead>
<tr class="header">
<th>Parameter</th>
<th style="text-align: center;">Options</th>
<th style="text-align: right;">Current setting</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Ngen</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">1000000</td>
</tr>
<tr class="even">
<td>Nruns</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td>Nchains</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td>Temp</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">0.100000</td>
</tr>
<tr class="odd">
<td>Reweight</td>
<td style="text-align: center;">number,number</td>
<td style="text-align: right;">0.00 v 0.00 ^</td>
</tr>
<tr class="even">
<td>Swapfreq</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>Nswaps</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td>Samplefreq</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="odd">
<td>Printfreq</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">500</td>
</tr>
<tr class="even">
<td>Printall</td>
<td style="text-align: center;">Yes/No</td>
<td style="text-align: right;">Yes</td>
</tr>
<tr class="odd">
<td>Printmax</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td>Mcmcdiagn</td>
<td style="text-align: center;">Yes/No</td>
<td style="text-align: right;">Yes</td>
</tr>
<tr class="odd">
<td>Diagnfreq</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">5000</td>
</tr>
<tr class="even">
<td>Diagnstat</td>
<td style="text-align: center;">Avgstddev/Maxstddev</td>
<td style="text-align: right;">Avgstddev</td>
</tr>
<tr class="odd">
<td>Minpartfreq</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="even">
<td>Allchains</td>
<td style="text-align: center;">Yes/No</td>
<td style="text-align: right;">No</td>
</tr>
<tr class="odd">
<td>Allcomps</td>
<td style="text-align: center;">Yes/No</td>
<td style="text-align: right;">No</td>
</tr>
<tr class="even">
<td>Relburnin</td>
<td style="text-align: center;">Yes/No</td>
<td style="text-align: right;">Yes</td>
</tr>
<tr class="odd">
<td>Burnin</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>Burninfrac</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="odd">
<td>Stoprule</td>
<td style="text-align: center;">Yes/No</td>
<td style="text-align: right;">No</td>
</tr>
<tr class="even">
<td>Stopval</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="odd">
<td>Savetrees</td>
<td style="text-align: center;">Yes/No</td>
<td style="text-align: right;">No</td>
</tr>
<tr class="even">
<td>Checkpoint</td>
<td style="text-align: center;">Yes/No</td>
<td style="text-align: right;">Yes</td>
</tr>
<tr class="odd">
<td>Checkfreq</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">100000</td>
</tr>
<tr class="even">
<td>Filename</td>
<td style="text-align: center;">name</td>
<td style="text-align: right;">primates.nex</td>
</tr>
<tr class="odd">
<td>Startparams</td>
<td style="text-align: center;">Current/Reset</td>
<td style="text-align: right;">Current</td>
</tr>
<tr class="even">
<td>Starttree</td>
<td style="text-align: center;">Current/Random/Parsimony</td>
<td style="text-align: right;">Current</td>
</tr>
<tr class="odd">
<td>Nperts</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td>Data</td>
<td style="text-align: center;">Yes/No</td>
<td style="text-align: right;">Yes</td>
</tr>
<tr class="odd">
<td>Ordertaxa</td>
<td style="text-align: center;">Yes/No</td>
<td style="text-align: right;">No</td>
</tr>
<tr class="even">
<td>Append</td>
<td style="text-align: center;">Yes/No</td>
<td style="text-align: right;">No</td>
</tr>
<tr class="odd">
<td>Autotune</td>
<td style="text-align: center;">Yes/No</td>
<td style="text-align: right;">Yes</td>
</tr>
<tr class="even">
<td>Tunefreq</td>
<td style="text-align: center;">number</td>
<td style="text-align: right;">100</td>
</tr>
</tbody>
</table>
<p><em>Example</em></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mcmc</span> ngen=1100000 samplefreq=200 printfreq=200 diagnfreq=2000</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If the standard deviation of split frequencies is below 0.01 the specific number of generations, stop the run by answering no when the program asks <code>Continue the analysis? (yes/no)</code>. Otherwise, keep adding generations until the value falls below <code>0.01</code>. If you are interested mainly in the well-supported parts of the tree, a standard deviation below <code>0.05</code> may be adequate.</p>
<p>Type <code>sump</code> to summarize the parameter values using the same burn-in as the diagnostics in the mcmc command. The program will output a table with summaries of the samples of the substitution model parameters, including the mean, mode, and 95 % credibility interval (region of Highest Posterior Density, HPD) of each parameter. Make sure that the potential scale reduction factor (PSRF) is reasonably close to 1.0 for all parameters; if not, you need to run the analysis longer.</p>
<p>Summarize the trees using the same burn-in as the mcmc command by typing <code>sumt</code>. The program will output a cladogram with the posterior probabilities for each split (file ending <code>.trprobs</code>) and a phylogram with mean branch lengths (file ending <code>.con.tre</code>). Both trees will also be printed to a file that can be read by FigTree and other tree-drawing programs, such as <code>TreeView</code> and <code>Mesquite</code>.</p>
<p>It does not have to be more complicated than this; however, as you get more proficient you will probably want to know more about what is happening behind the scenes. The rest of this section explains each of the steps in more detail and introduces you to all the implicit assumptions you are making and the machinery that MrBayes uses in order to perform your analysis.</p>
</section>
<section id="altering-the-model" class="level3">
<h3 class="anchored" data-anchor-id="altering-the-model">Altering the model</h3>
<p><strong>GTR</strong></p>
<p>GTR <code>lset nst=6</code></p>
<p>GTR + G <code>lset nst=6 rates=gamma</code></p>
<p>GTR + I <code>lset nst=6 rates=inv</code></p>
<p>GTR + G + I <code>lset nst=6 rates=gammainv</code></p>
<p><strong>K2P</strong></p>
<p>Use the HKY model and set the stationary state frequencies to be equal, this will give you a K2P model</p>
<p>K2P <code>lset nst=2</code> <code>prset statefreqpr=fixed(equal)</code></p>
<p>K2P + G <code>lset nst=2 rates=gamma</code> <code>prset statefreqpr=fixed(equal)</code></p>
<p>K2P + I <code>lset nst=2 rates=inv</code> <code>prset statefreqpr=fixed(equal)</code></p>
<p>K2P + G + I <code>lset nst=2 rates=invgamma</code> <code>prset statefreqpr=fixed(equal)</code></p>
<p><strong>HKY</strong></p>
<p>HKY <code>lset nst=2</code></p>
<p>HKY + G <code>lset nst=2 rates=gamma</code></p>
<p>HKY + I <code>lset nst=2 rates=inv</code></p>
<p>HKY + G + I <code>lset nst=2 rates=gammainv</code></p>
<hr>
</section>
</section>
<section id="web-server" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="web-server">Web server</h2>
<p>You can also use MrBayes via a web server, There is a variety to choose, check their limitations with regards to compute power to ensure it is going to work for you.</p>
<p>We’ll use the sever by <a href="http://www.phylogeny.fr/one_task.cgi?task_type=mrbayes">MABL, MrBayes 3.2.6</a> for this example. Some limitations of this web server are:</p>
<ul>
<li>Max number of sequences = 30</li>
<li>Max number of generations for MCMC analysis = 100,000</li>
</ul>
<p>The interface looks like this:</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="mrbayes2.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">MABL Webserver for MyBayes</figcaption>
</figure>
</div>
<section id="upload-data" class="level3">
<h3 class="anchored" data-anchor-id="upload-data">1. Upload data</h3>
<p>Upload your alignment either by pasting into box provided or uploading file. File formats accepted <code>FASTA</code>, <code>Phylip</code>, <code>Clustal</code>, <code>EMBL</code> or <code>NEXUS</code>.</p>
</section>
<section id="setting" class="level3">
<h3 class="anchored" data-anchor-id="setting">2. Setting</h3>
<p>Select your desired settings. If you are unsure below is a suggestions of where to start for analysing nucleotide data.</p>
<p>Likelihood model</p>
<ul>
<li>Number of substitution types: <code>6 (GTR)</code></li>
<li>Substitution model: <code>4by4</code></li>
<li>Rates variation across sites: <code>invgamma</code></li>
</ul>
<p>Markov Chain Monte Carlo parameters</p>
<ul>
<li>Number of generations: <code>100 000</code></li>
<li>Sample a tree every <code>100</code> generations</li>
</ul>
<p>Summarize results</p>
<ul>
<li>Discard first <code>500</code> trees sampled (burnin)</li>
</ul>
</section>
<section id="submit" class="level3">
<h3 class="anchored" data-anchor-id="submit">3. Submit</h3>
<p>Enter your email to receive a notification when analysis is complete and click <code>Submit</code></p>
</section>
<section id="output" class="level3">
<h3 class="anchored" data-anchor-id="output">4. Output</h3>
<p>Click on the link in the email and it will take you to this screen</p>
<p><img src="mrbayes3.png" class="img-fluid"></p>
<p>Download the tree by right clicking on <code>Tree in Newick format</code> under the heading <strong>Outputs</strong> and select <code>Save link as...</code> with the <code>.tree</code> file format. You can open the file in something like <a href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a>, node/branch labels reflect the poster probabilities of the analysis.</p>
<p>The analysis information is available by downloading the <code>MrBayes logs</code> file under the <strong>Outputs</strong> heading.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="siobhon-egan/siobhon-egan.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2022, Siobhon Egan</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/siobhon-egan/siobhon-egan.github.io">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/siobhon_egan">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>